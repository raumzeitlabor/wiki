{{ProjektInfoBox
|name        = Moodlamp
|status      = beta
|image       = Moodlamp01.jpg
|description = Lecker-bunte Farblaterne
|author      = TabascoEye
|username    = 
|version     = 1.5
|update      = 
|platform    = 
|license     = 
|download    = [http://github.com/tiefpunkt/Moodlamp Firmware(Github)]
}}
Weil bunte, blinkende Lichter, die man steuern kann toll sind, wollen wir Moodlamps bauen.
Beim eh2010 in München gab es schon nette Moodlamps, die aber SMD Bauteile beinhalten und deshalb für Anfänger sehr schwer zu löten sind.
Wir wollten eine Moodlamp mit bedrahteten Bauteilen fertigen.
Die Erlanger haben sich das auch schon gedacht und sind damit soweit fertig, weshalb wir uns dieses Design klauen (danke Erlangen).

==Bausätze==
Aktuell kann man MoodLamp Bausätze in zwei verschiedenen Ausführungen hier im RaumZeitLabor günstig erstehen.

===MoodLamp V2 economy===
BYOCAR - Bring your own case and remote
====Inhalt====
* 3 Watt RGB LED
* ATmega328p
* IR Empfänger
* Netzteil
* alle weiteren Bauteile
====Preis====
Mindestens 25 EUR

===MoodLamp V2 premium===
Beinhaltet eine der unterstützen Fernbedienungen sowie ein ultimativ geniales Lampengehäuse als Diffusor
====Inhalt====
Ergänzend zum Inhalt der MoodLamp V2 Economy:
* IKEA FADO Glaslamp
* IR-Fernbedienung, die speziell für RGB-LEDs gedacht ist
====Preis====
Mindestens 40 EUR

==Hardware==
===Version 1===
* Genau nach Vorlage der Erlanger Moodlamp
* hier: http://git.informatik.uni-erlangen.de/?p=hawo-moodlight/.git;a=blob;f=moodlight.brd;h=1e5b2dfb06c48103af19aaade9f18cce0dfacaa8;hb=HEAD gibts das Eagle layout für die Erlanger boards.
* Und hier http://git.informatik.uni-erlangen.de/?p=hawo-moodlight/.git;a=blob;f=moodlight.sch;h=783581f14790a23bafa9855cb4fe9d82c3f8b828;hb=refs/heads/master den schaltplan.

====Bauteile====
{| border="1" cellspacing="0" cellpadding="5"
|-----
! Bezeichung || Bezugsquelle || Link || Preis 
|-----
|3 Watt RGB LED Modul || LED-Tech || http://www.led-tech.de/de/High-Power-LEDs-Edison/Edixeon-RGB/Edison-Edixeon-RGB-Star-LT-1470_142_147.html || 7,90€
|-----
|Kühlkörper Stern || LED-Tech || http://www.led-tech.de/de/High-Power-Zubehoer/Kuehlkoerper/Sternkuehlkoerper-51x51mm-LT-1461_106_114.html || 0,99€
|-----
|IR Modul TSOP  31238 || Farnell || http://de.farnell.com/vishay-semiconductor/tsop31238/ir-emitter-38khz/dp/1469635?Ntt=TSOP+31238
|| 1,14€
|-----
|RFM12 Modul (funk<->seriell) || CSD || http://www.csd-electronics.de/de/groups/g_273/items3443.htm || 3,95€
|-----
|Kleinteile (inkl. ISP wannenstecker, Hausbuswandler, Litze...) || Reichelt || http://www.reichelt.de/?ACTION=20;AWKID=292918;PROVID=2084  || 7,27€ 
|-----
| || || '''GESAMT''' || '''~23€'''
|-----
| Lampenngehäuse FADO || IKEA || http://www.ikea.com/de/de/catalog/products/80096372 || 9,99€
|}

Also für knapp über 30Euro eine selbstgebaute, voll steuerbare RGB Moodlamp \o/


====Lochraster Layout====
Hier das krude layout, um die bisherige version (pre-redesign) erstmal zu bauen.
{|
| [[Datei:Moodlamp-board.png|400px|thumb|Moodlampschaltung 1.0]]
| [[Datei:Moodlamp_bw.png|400px|thumb|Moodlampschaltung 1.0]]
|}

* Die Transistoren (BD139) mit dem metallischen Teil vom Atmel weg zeigend einbauen!
* Wer schon einen Bausatz hat: Die Widerstände sind falsch. Als Abhilfe genügt es zur Zeit, ROT und GRÜN mit den 10ohm Widerständen auszustatten, und BLAU mit dem 6,8ohm.


Hier das neue Kompaktlayout (Danke Tiefpunkt fürs Routen und DaFo für Lochmaster)
{|
| [[Datei:Moodlamp_1.5_top.png|400px|thumb|Moodlampschaltung 1.5 oben]]
| [[Datei:Moodlamp_1.5_bottom.png|400px|thumb|Moodlampschaltung 1.5 unten]]
|}

====Lessons learned====
* Klebende Wärmeleitpads benutzen (mitbestellen bei led-tech) statt Wärmeleitkleber. Sauerei und nervig bis zum Aushärten.
* Bauteile VOR der Bestellung nochmal sorgfältig verifizieren (IC Sockel, Verpolungsdiode, fehlende Widerstände)
* Schaltungen immer mal in Frage stellen. Wir werden die Schaltung re-designen...
* Einbaurichtung von Transistoren ordentlich dokumentieren
* LED Vorwiderstände in Frage stellen m(
* Unterschiede von Pinkompatiblen Atmels *soifz* ==> ATmega328p oder 168 will man nehmen (16 oder 32K statt 4)


===Version 2.0===
Und hier das derzeitige Layout V2.0
{|
| [[Datei:Moodlamp2.0 RZL.png|400px|thumb|Moodlamp V2.0 oben]]
| [[Datei:Moodlamp2.0 RZL back.png|400px|thumb|Moodlamp V2.0 unten]]
|}

'''WICHTIG: Der Plan ist noch nicht final. Work in progress, please wait...'''

TODO:
* Schaltplan
* Neue IR-LEDs berücksichtigen
* Vorwiderstände für die Transistoren
* Pullup für Reset-Pin
* RFM12 (Andere Bauform)

==Firmware==
===Fuses===
 avrdude -c usbasp -p m48 -U lfuse:w:0xff:m -U hfuse:w:0xde:m
* Der Befehl setzt einen USBasp als Programmer vorraus
* Auf dem USBasp vor dem Setzen der Fuses den "Slow SCK"-Jumper (J3, der zwischen den beiden LEDs) setzen. Die anderen Jumper dürfen nicht gesetzt sein!

===Source===
Angepasst auf Moodlamp v2.0 mit neuer Fernbedienung. Fernbedienungsfunktionen abgedeckt, die Helligkeits-Buttons regeln die Geschwindigkeit der Modi "FADE" und "SMOOTH".
[http://github.com/tiefpunkt/Moodlamp http://github.com/tiefpunkt/Moodlamp]

==Fotos==
{|
| [[Datei:2010-10-14 00.52.10.jpg|400px|thumb|Aufgebaute Moodlamp v1.5 von tiefpunkt]]
| [[Datei:Moodlamp01.jpg|277px|thumb|Moodlamp in Betrieb, mit passender Fernbedienung]]
|}

{|
| [[Datei:BackLEDs.JPG|277px|thumb|Moodlamp LEDs aus dem Backofen]]
|}

==Planung==
===Kurzfristig===
* IR-Fernbedienungen
** <del>Neue China-Fernbedienung</del> - '''DONE'''
** <del>RC5 (wie bei v1.0)</del> - '''DONE'''
* <del>Mehrere Fading-Modi</del> - '''DONE'''
* Makefile-Anpassung
* Neuen Code mit IR auf 4k schrumpfen, wenn möglich (Support für alte Moodlamp)

===Mittel-/Langfristig===
* Steuerung über RFM12-Chip --> Chip schon vorhanden, muss nur angesprochen werden!
* Steuerung über Audiosignal
* DMX? Hausbus?
* USB, Zusammenführung mit [[Rfm12usb]]
* Schaltplan für die Moodlamp v2
* Lochraster-Layout für die Moodlamp v2 überarbeiten (evtl. mit Pinheadern für RS232 Debugging und Herausführung aller nicht verwendeten Atmel-Pins?)

[[Kategorie:Projekt]][[Kategorie: KleinProzessorZüchter]]
