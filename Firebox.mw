Die ASG (Astaro Security Gateway) ist unser derzeitiger Router. Die Aufgaben sind:

* IPv4-Internet bereitstellen (getunnelt über Schweden)
* IPv6-Internet bereitstellen (getunnelt über docsteel)
* Türstatus ermitteln und auf status.raumzeitlabor.de laden, dafür auch Hausbusmaster sein
* Via [[NPM 2000|NPM]] Switch ein-/ausschalten (und damit Rundumleuchten für den [[Ping]])
* DNS, DHCP, radvd, firewall
* Zugang ins dn42
* Internetauslastung und Latenz monitoren und auf cosm hochladen

== Hardware ==

* Intel(R) CPU
* 512 MB RAM
* 8 Ethernet-Ports
* 19"-Gehäuse, 1HE
* Linux

== Software ==
;DHCP: isc-dhcp-server
;DNS: bind9 (master für .rzl und 36.22.172.in-addr.arpa und 37.22.172.in-addr.arpa)
;radvd: radvd
;VPNs: openvpn
;Firewall: iptables
;Scripte: eingenes, wohldokumentiertes, Zeug

== Adminstuff ==
=== Scripte ===
$Dinge funktionieren noch nicht per init script, sondern in einem screen.

Nach einem Reboot sollte folgendes ausgeführt werden (bitte in einem und nicht pro Dienst einen eigenen):
''(Ist der Code Block unten gemeint?)''

Nach einem reboot müssen die beiden auskommentierten Zeilen in /root/start-tuerstatus.sh ausgeführt werden (/tmp/rrd erstellen und n paar default dateien da hin schieben).

<code><pre>
/root/start-hausbus.sh
/root/start-tuerstatus.sh
/root/start-npmd.sh
while [ 1 ]; do sh /root/raumstatus-meta.sh; sleep 30; done
cd /root/internetmeter; ./main
</pre></code>

Initscripte kommen $bald™.

=== Serielle Schnittstelle ===

Die ASG hat eine serielle Schnittstelle: Wird aber nich genutzt aktuell.

=== Busmaster-Reset ===

<pre>
curl -d 0 -X PUT http://localhost:5000/port/2
curl -d 1 -X PUT http://localhost:5000/port/2
</pre>

=== NPM Reset ===
Falls der npmd abstürzt und keine Verbindung mehr zum [[NPM 2000|NPM]] bekommt: hingehen, NPM ausschalten (hinten Links), wieder einschalten, nochmal versuchen. Am [[NPM 2000|NPM]] hängt neben dem [[Hausbus|Busmaster]] auch der [[Switch|Hauptswitch]]. [[Netzwerk]] ist dann also auch kurz komplett weg.

[[Kategorie:Hardware]]
